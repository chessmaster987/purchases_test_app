{% extends "base.html" %}
{% block content %}
<h2 class="mb-4">Статистика</h2>

<div class="card p-3 mb-4">
    <h4>Загальна сума: <span class="text-success">{{ total }} zł</span></h4>
</div>

<div class="row">
    <div class="col-md-6">
        <h5>По магазинах:</h5>
        <ul class="list-group mb-4">
        {% for shop, sum in shops.items() %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                {{ shop }}
                <span class="badge bg-primary rounded-pill">{{ "%.2f"|format(sum) }} zł</span>
            </li>
        {% endfor %}
        </ul>

        <h5>По категоріях:</h5>
        <ul class="list-group mb-4">
        {% for cat, sum in categories_sum|dictsort(false, by='value') %}
            {% if sum > 0 %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                {{ cat }}
                <span class="badge bg-warning text-dark rounded-pill">{{ "%.2f"|format(sum) }} zł</span>
            </li>
            {% endif %}
        {% endfor %}
        </ul>
    </div>

    <div class="col-md-6">
        <h5>Останні покупки:</h5>
        <ul class="list-group">
        {% for p in purchases %}
            <li class="list-group-item">
                <strong>{{ p.date }}</strong> |
                <span class="text-muted">{{ p.shop }}</span> |
                <span class="fw-bold">{{ "%.2f"|format(p.amount) }} zł</span>
                <br>
                <small>{{ p.desc }}</small>
                {% if p.receipt %}
                    <br><img src="{{ p.receipt }}" class="img-fluid mt-2" style="max-width:150px;">
                {% endif %}
            </li>
        {% endfor %}
        </ul>
    </div>
</div>
{% endblock %}
